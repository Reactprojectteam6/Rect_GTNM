{"ast":null,"code":"import _defineProperty from \"C:\\\\Users\\\\kieu\\\\Desktop\\\\final_project\\\\my_app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//Login\nimport axios from 'axios';\nconst SET_LOGIN = 'SET_LOGIN';\nexport function login(email, password) {\n  //reducer thuc hien action login xu ly du lieu lay qua\n  console.log(\"abcdds\"); //, {headers: {'Content-Type':'application/json','Access-Control-Allow-Origin': '*'}}\n\n  return async dispatch => {\n    axios.get(\"https://127.0.0.1:5001/api/Token/\".concat(email, \"/\").concat(password)).then(response => {\n      console.log(response);\n      if (response.status == \"400\") dispatch({\n        type: SET_LOGIN,\n        payload: false\n      });else {\n        //localStorage.setItem(\"token\",response.data);\n        document.cookie = \"token=\".concat(response.data);\n        axios.get(\"https://127.0.0.1:5001/api/user/\".concat(email)).then(response => {\n          if (response.data.length > 0) {\n            console.log(\"sfsdjfhsdf\");\n            const user = response.data;\n            const currentUser = {\n              id: user[0].id,\n              user_name: user[0].user_name,\n              email: user[0].email,\n              address: user[0].address,\n              is_admin: user[0].is_admin\n            };\n            localStorage.setItem('currentUser', JSON.stringify(currentUser));\n          }\n        });\n        dispatch({\n          type: SET_LOGIN,\n          payload: true\n        });\n      }\n    }).catch(err => console.log(err));\n  };\n}\nexport function logout() {\n  //reducer thuc hien action login xu ly du lieu lay qua\n  return dispatch => {\n    localStorage.clear();\n    document.cookie = \"token=; expires=Wed, 27 Feb 2019 07:41:28 GMT;\";\n    dispatch({\n      type: SET_LOGIN,\n      payload: false\n    });\n  };\n}\n\nfunction getCookie(cname) {\n  var name = cname + \"=\";\n  var ca = document.cookie.split(';');\n\n  for (var i = 0; i < ca.length; i++) {\n    var c = ca[i];\n\n    while (c.charAt(0) == ' ') {\n      c = c.substring(1);\n    }\n\n    if (c.indexOf(name) == 0) {\n      return c.substring(name.length, c.length);\n    }\n  }\n\n  return \"\";\n}\n\nvar a = false;\nvar data = getCookie('token');\nif (data != null) a = true;\nvar login_state = {\n  isLoginSuccess: a\n};\nexport default function login_reducer(state = login_state, action) {\n  if (action.type == 'SET_LOGIN') {\n    let newState = _objectSpread({}, state);\n\n    console.log(action.payload);\n    newState.isLoginSuccess = action.payload;\n    return newState;\n  }\n\n  return state;\n}","map":{"version":3,"sources":["C:/Users/kieu/Desktop/final_project/my_app/src/redux/login_reducer.js"],"names":["axios","SET_LOGIN","login","email","password","console","log","dispatch","get","then","response","status","type","payload","document","cookie","data","length","user","currentUser","id","user_name","address","is_admin","localStorage","setItem","JSON","stringify","catch","err","logout","clear","getCookie","cname","name","ca","split","i","c","charAt","substring","indexOf","a","login_state","isLoginSuccess","login_reducer","state","action","newState"],"mappings":"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","sourcesContent":["//Login\r\nimport axios from 'axios';\r\nconst SET_LOGIN = 'SET_LOGIN';\r\nexport function login(email, password) { \r\n  //reducer thuc hien action login xu ly du lieu lay qua\r\n  console.log(\"abcdds\");\r\n  //, {headers: {'Content-Type':'application/json','Access-Control-Allow-Origin': '*'}}\r\n  return async dispatch => {\r\n   \r\n  axios.get(`https://127.0.0.1:5001/api/Token/${email}/${password}`).then(response => {\r\n      console.log(response);\r\n        if(response.status==\"400\") dispatch ({type:SET_LOGIN, payload:false});\r\n        else { //localStorage.setItem(\"token\",response.data);\r\n        document.cookie = `token=${response.data}`;\r\n      axios.get(`https://127.0.0.1:5001/api/user/${email}`).then(response => {\r\n       if(response.data.length>0) \r\n       {  console.log(\"sfsdjfhsdf\");\r\n        const user = response.data;\r\n        const currentUser={\r\n          id:user[0].id,\r\n          user_name:user[0].user_name,\r\n          email:user[0].email,\r\n          address:user[0].address,\r\n          is_admin:user[0].is_admin\r\n        }\r\n         localStorage.setItem('currentUser',JSON.stringify(currentUser));\r\n        \r\n       }\r\n            }\r\n      )\r\n          dispatch ({type:SET_LOGIN, payload:true});\r\n    }\r\n     \r\n    }).catch(err => console.log(err));\r\n}\r\n  \r\n}\r\nexport function logout() { //reducer thuc hien action login xu ly du lieu lay qua\r\n  return dispatch => {\r\n    localStorage.clear();\r\n    document.cookie = \"token=; expires=Wed, 27 Feb 2019 07:41:28 GMT;\";\r\n    dispatch ({type:SET_LOGIN, payload:false});\r\n}\r\n}\r\nfunction getCookie(cname) {\r\n  var name = cname + \"=\";\r\n  var ca = document.cookie.split(';');\r\n  for(var i = 0; i <ca.length; i++) {\r\n      var c = ca[i];\r\n      while (c.charAt(0)==' ') {\r\n          c = c.substring(1);\r\n      }\r\n      if (c.indexOf(name) == 0) {\r\n          return c.substring(name.length,c.length);\r\n      }\r\n  }\r\n  return \"\";\r\n}\r\n\r\nvar a=false;\r\n var data=getCookie('token');\r\n if(data!=null) a=true;\r\nvar login_state={\r\n \r\n  isLoginSuccess:a,\r\n}\r\nexport default function login_reducer(state =login_state, action) {\r\n  \r\n  if(action.type=='SET_LOGIN')\r\n  {  let newState={...state};\r\n      console.log(action.payload);\r\n     newState.isLoginSuccess=action.payload\r\n     return newState;\r\n   }\r\n   return state;\r\n  \r\n}"]},"metadata":{},"sourceType":"module"}