{"ast":null,"code":"import _defineProperty from \"C:\\\\Users\\\\kieu\\\\Desktop\\\\final_project\\\\my_app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//Login\nimport axios from 'axios';\nconst SET_LOGIN = 'SET_LOGIN';\nexport function login(email, password) {\n  //reducer thuc hien action login xu ly du lieu lay qua\n  console.log(\"abcdds\"); //, {headers: {'Content-Type':'application/json','Access-Control-Allow-Origin': '*'}}\n\n  return async dispatch => {\n    axios.get(\"https://127.0.0.1:5001/api/Token/\".concat(email, \"/\").concat(password)).then(response => {\n      console.log(response);\n      var token = \"\";\n      if (response.status == \"400\") dispatch({\n        type: SET_LOGIN,\n        payload: false\n      });else {\n        //localStorage.setItem(\"token\",response.data);\n        localStorage.setItem(\"token\", response.data);\n        token = 'Bearer ' + localStorage.getItem(\"token\");\n        console.log(token);\n        axios({\n          method: 'get',\n          url: \"https://127.0.0.1:5001/api/User/email=buithikieu16tclc3@gmail.com\",\n          headers: {\n            'Authorization': token,\n            'Content-Type': 'application/json'\n          }\n        }).then(response => {\n          if (response.data != null) {\n            console.log(\"sfsdjfhsdf\");\n            console.log(response.data);\n            const user = response.data;\n            const currentUser = {\n              id: user[0].id,\n              user_name: user[0].user_name,\n              email: user[0].email,\n              address: user[0].address,\n              is_admin: user[0].is_admin\n            };\n            localStorage.setItem('currentUser', JSON.stringify(currentUser));\n          }\n        });\n        dispatch({\n          type: SET_LOGIN,\n          payload: true\n        });\n      }\n    }).catch(err => console.log(err));\n  };\n}\nexport function logout() {\n  //reducer thuc hien action login xu ly du lieu lay qua\n  return dispatch => {\n    localStorage.clear(); //document.cookie = \"token=; expires=Wed, 27 Feb 2019 07:41:28 GMT;\";\n\n    dispatch({\n      type: SET_LOGIN,\n      payload: false\n    });\n  };\n}\n\nfunction getCookie(cname) {\n  var name = cname + \"=\";\n  var ca = document.cookie.split(';');\n\n  for (var i = 0; i < ca.length; i++) {\n    var c = ca[i];\n\n    while (c.charAt(0) == ' ') {\n      c = c.substring(1);\n    }\n\n    if (c.indexOf(name) == 0) {\n      return c.substring(name.length, c.length);\n    }\n  }\n\n  return \"\";\n}\n\nvar a = false;\nvar data = localStorage.getItem('token');\nconsole.log(data);\nif (data != null) a = true;\nvar login_state = {\n  isLoginSuccess: a\n};\nexport default function login_reducer(state = login_state, action) {\n  if (action.type == 'SET_LOGIN') {\n    let newState = _objectSpread({}, state);\n\n    console.log(action.payload);\n    newState.isLoginSuccess = action.payload;\n    return newState;\n  }\n\n  return state;\n}","map":{"version":3,"sources":["C:/Users/kieu/Desktop/final_project/my_app/src/redux/login_reducer.js"],"names":["axios","SET_LOGIN","login","email","password","console","log","dispatch","get","then","response","token","status","type","payload","localStorage","setItem","data","getItem","method","url","headers","user","currentUser","id","user_name","address","is_admin","JSON","stringify","catch","err","logout","clear","getCookie","cname","name","ca","document","cookie","split","i","length","c","charAt","substring","indexOf","a","login_state","isLoginSuccess","login_reducer","state","action","newState"],"mappings":"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","sourcesContent":["//Login\r\nimport axios from 'axios';\r\nconst SET_LOGIN = 'SET_LOGIN';\r\nexport function login(email, password) { \r\n  //reducer thuc hien action login xu ly du lieu lay qua\r\n  console.log(\"abcdds\");\r\n  //, {headers: {'Content-Type':'application/json','Access-Control-Allow-Origin': '*'}}\r\n  return async dispatch => {\r\n   \r\n  axios.get(`https://127.0.0.1:5001/api/Token/${email}/${password}`).then(response => {\r\n      console.log(response);\r\n      var token=\"\";\r\n        if(response.status==\"400\") dispatch ({type:SET_LOGIN, payload:false});\r\n        else { //localStorage.setItem(\"token\",response.data);\r\n        localStorage.setItem(\"token\",response.data)\r\n        token='Bearer '+localStorage.getItem(\"token\");\r\n        console.log(token);\r\n        axios({\r\n          method: 'get',\r\n          url: `https://127.0.0.1:5001/api/User/email=buithikieu16tclc3@gmail.com`,\r\n          headers:{\r\n            'Authorization':token,\r\n            'Content-Type':'application/json',\r\n           \r\n          }\r\n        }).then(response => {\r\n       if(response.data!=null) \r\n       {  console.log(\"sfsdjfhsdf\");\r\n          console.log(response.data);\r\n          const user = response.data;\r\n          const currentUser={\r\n          id:user[0].id,\r\n          user_name:user[0].user_name,\r\n          email:user[0].email,\r\n          address:user[0].address,\r\n          is_admin:user[0].is_admin\r\n        }\r\n         localStorage.setItem('currentUser',JSON.stringify(currentUser));\r\n        \r\n       }\r\n            }\r\n      )\r\n          dispatch ({type:SET_LOGIN, payload:true});\r\n    }\r\n     \r\n    }).catch(err => console.log(err));\r\n}\r\n  \r\n}\r\nexport function logout() { //reducer thuc hien action login xu ly du lieu lay qua\r\n  return dispatch => {\r\n    localStorage.clear();\r\n    //document.cookie = \"token=; expires=Wed, 27 Feb 2019 07:41:28 GMT;\";\r\n    dispatch ({type:SET_LOGIN, payload:false});\r\n}\r\n}\r\nfunction getCookie(cname) {\r\n  var name = cname + \"=\";\r\n  var ca = document.cookie.split(';');\r\n  for(var i = 0; i <ca.length; i++) {\r\n      var c = ca[i];\r\n      while (c.charAt(0)==' ') {\r\n          c = c.substring(1);\r\n      }\r\n      if (c.indexOf(name) == 0) {\r\n          return c.substring(name.length,c.length);\r\n      }\r\n  }\r\n  return \"\";\r\n}\r\n\r\nvar a=false;\r\n var data=localStorage.getItem('token');\r\n console.log(data);\r\n if(data!=null) a=true;\r\nvar login_state={\r\n \r\n  isLoginSuccess:a,\r\n}\r\nexport default function login_reducer(state =login_state, action) {\r\n  \r\n  if(action.type=='SET_LOGIN')\r\n  {  let newState={...state};\r\n      console.log(action.payload);\r\n     newState.isLoginSuccess=action.payload\r\n     return newState;\r\n   }\r\n   return state;\r\n  \r\n}"]},"metadata":{},"sourceType":"module"}