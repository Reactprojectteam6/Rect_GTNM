{"ast":null,"code":"import _defineProperty from \"C:\\\\Users\\\\kieu\\\\Desktop\\\\final_project\\\\my_app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//Login\nimport axios from 'axios';\nconst SET_LOGIN = 'SET_LOGIN';\nconst CHECK_LOGIN = 'CHECK_LOGIN';\nconst LOG_OUT = 'LOG_OUT';\nexport function login(email, password) {\n  //reducer thuc hien action login xu ly du lieu lay qua\n  console.log(\"abcdds\"); //, {headers: {'Content-Type':'application/json','Access-Control-Allow-Origin': '*'}}\n\n  return async dispatch => {\n    axios.get(\"https://127.0.0.1:5001/api/Token/\".concat(email, \"/\").concat(password)).then(response => {\n      var token = \"\";\n\n      if (response.status == \"404\") {\n        alert(\"khong\");\n        dispatch({\n          type: SET_LOGIN,\n          payload: false\n        });\n      } else {\n        //localStorage.setItem(\"token\",response.data);\n        localStorage.setItem(\"token\", response.data);\n        token = 'Bearer ' + localStorage.getItem(\"token\");\n        console.log(token);\n        axios({\n          method: 'get',\n          url: \"https://127.0.0.1:5001/api/User/email=\".concat(email),\n          headers: {\n            'Content-Type': 'application/json',\n            Accept: 'application/json',\n            'Authorization': token\n          }\n        }).then(response => {\n          if (response.data != null) {\n            console.log(\"sfsdjfhsdf\"); //console.log(response.data);\n\n            const user = response.data;\n            const currentUser = {\n              id: user.id,\n              user_name: user.user_name,\n              email: user.email,\n              address: user.address,\n              role: user.role,\n              phone: user.phone\n            };\n            localStorage.setItem('currentUser', JSON.stringify(currentUser));\n            dispatch({\n              type: SET_LOGIN,\n              payload: true,\n              user: JSON.parse(localStorage.getItem('currentUser'))\n            });\n          }\n        });\n      }\n    }).catch(err => console.log(err));\n  };\n}\nexport function logout() {\n  //reducer thuc hien action login xu ly du lieu lay qua\n  return dispatch => {\n    localStorage.clear(); //document.cookie = \"token=; expires=Wed, 27 Feb 2019 07:41:28 GMT;\";\n\n    dispatch({\n      type: LOG_OUT,\n      payload: false\n    });\n  };\n}\n\nfunction getCookie(cname) {\n  var name = cname + \"=\";\n  var ca = document.cookie.split(';');\n\n  for (var i = 0; i < ca.length; i++) {\n    var c = ca[i];\n\n    while (c.charAt(0) == ' ') {\n      c = c.substring(1);\n    }\n\n    if (c.indexOf(name) == 0) {\n      return c.substring(name.length, c.length);\n    }\n  }\n\n  return \"\";\n}\n\nexport function checkLogin() {\n  //reducer thuc hien action login xu ly du lieu lay qua\n  return dispatch => {\n    var a = localStorage.getItem('token');\n    if (a != null) dispatch({\n      type: CHECK_LOGIN,\n      payload: true\n    });else {\n      alert(\"vui long dang nhap de mua hang\");\n      dispatch({\n        type: CHECK_LOGIN,\n        payload: false\n      });\n    }\n  };\n}\nvar a = false;\nvar data = localStorage.getItem('token');\nvar user = JSON.parse(localStorage.getItem('currentUser'));\nconsole.log(data);\nif (data != null) a = true;\nvar login_state = {\n  isLoginSuccess: a,\n  currentUser: user ? user : [],\n  checkLogin: false\n};\nexport default function login_reducer(state = login_state, action) {\n  if (action.type == 'SET_LOGIN') {\n    let newState = _objectSpread({}, state);\n\n    console.log(action.payload);\n    newState.isLoginSuccess = action.payload;\n    newState.currentUser = action.user;\n    console.log(newState.isLoginSuccess);\n    if (newState.isLoginSuccess == true) alert(\"dang nhap thanh cong\");else if (newState.isLoginSuccess == false) alert(\"ban khong dang nhap duoc,vui long kiem tra lai\");\n    return newState;\n  }\n\n  if (action.type == 'CHECK_LOGIN') {\n    let newState = _objectSpread({}, state);\n\n    newState.checkLogin = action.payload;\n    return newState;\n  }\n\n  if (action.type == 'LOG_OUT') {\n    let newState = _objectSpread({}, state);\n\n    newState.isLoginSuccess = action.payload;\n    if (newState.isLoginSuccess == false) alert('da log out');\n    newState.currentUser = [];\n    return newState;\n  }\n\n  return state;\n}","map":{"version":3,"sources":["C:/Users/kieu/Desktop/final_project/my_app/src/redux/login_reducer.js"],"names":["axios","SET_LOGIN","CHECK_LOGIN","LOG_OUT","login","email","password","console","log","dispatch","get","then","response","token","status","alert","type","payload","localStorage","setItem","data","getItem","method","url","headers","Accept","user","currentUser","id","user_name","address","role","phone","JSON","stringify","parse","catch","err","logout","clear","getCookie","cname","name","ca","document","cookie","split","i","length","c","charAt","substring","indexOf","checkLogin","a","login_state","isLoginSuccess","login_reducer","state","action","newState"],"mappings":"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","sourcesContent":["//Login\r\nimport axios from 'axios';\r\nconst SET_LOGIN = 'SET_LOGIN';\r\nconst CHECK_LOGIN='CHECK_LOGIN';\r\nconst LOG_OUT='LOG_OUT';\r\nexport function login(email, password) { \r\n  //reducer thuc hien action login xu ly du lieu lay qua\r\n  console.log(\"abcdds\");\r\n  //, {headers: {'Content-Type':'application/json','Access-Control-Allow-Origin': '*'}}\r\n  return async dispatch => {\r\n   \r\n  axios.get(`https://127.0.0.1:5001/api/Token/${email}/${password}`).then(response => {\r\n      var token=\"\";\r\n        if(response.status==\"404\"){ alert(\"khong\") ;dispatch({type:SET_LOGIN, payload:false});}\r\n        else { //localStorage.setItem(\"token\",response.data);\r\n        localStorage.setItem(\"token\",response.data)\r\n        token='Bearer '+localStorage.getItem(\"token\");\r\n        console.log(token);\r\n        axios({\r\n          method: 'get',\r\n          url: `https://127.0.0.1:5001/api/User/email=${email}`,\r\n          headers:{\r\n            'Content-Type': 'application/json',\r\n            Accept: 'application/json',\r\n            'Authorization':token\r\n          }\r\n         \r\n        }).then(response => {\r\n       if(response.data!=null) \r\n       {  console.log(\"sfsdjfhsdf\");\r\n          //console.log(response.data);\r\n          const user = response.data;\r\n          const currentUser={\r\n          id:user.id,\r\n          user_name:user.user_name,\r\n          email:user.email,\r\n          address:user.address,\r\n          role:user.role,\r\n          phone:user.phone,\r\n        }\r\n         localStorage.setItem('currentUser',JSON.stringify(currentUser));\r\n         dispatch ({type:SET_LOGIN, payload:true,user:JSON.parse(localStorage.getItem('currentUser'))});\r\n      \r\n       }\r\n            }\r\n      )\r\n  \r\n     \r\n    \r\n    }\r\n     \r\n    }).catch(err => console.log(err));\r\n}\r\n  \r\n}\r\nexport function logout() { //reducer thuc hien action login xu ly du lieu lay qua\r\n  return dispatch => {\r\n    localStorage.clear();\r\n    //document.cookie = \"token=; expires=Wed, 27 Feb 2019 07:41:28 GMT;\";\r\n    dispatch ({type:LOG_OUT, payload:false});\r\n}\r\n}\r\nfunction getCookie(cname) {\r\n  var name = cname + \"=\";\r\n  var ca = document.cookie.split(';');\r\n  for(var i = 0; i <ca.length; i++) {\r\n      var c = ca[i];\r\n      while (c.charAt(0)==' ') {\r\n          c = c.substring(1);\r\n      }\r\n      if (c.indexOf(name) == 0) {\r\n          return c.substring(name.length,c.length);\r\n      }\r\n  }\r\n  return \"\";\r\n}\r\nexport function checkLogin() { //reducer thuc hien action login xu ly du lieu lay qua\r\n  return dispatch => {\r\n    var a=localStorage.getItem('token');\r\n    if(a!=null)\r\n    dispatch ({type:CHECK_LOGIN, payload:true});\r\n    else   { alert(\"vui long dang nhap de mua hang\");dispatch ({type:CHECK_LOGIN, payload:false});}\r\n}\r\n}\r\nvar a=false;\r\n var data=localStorage.getItem('token');\r\n var user=JSON.parse(localStorage.getItem('currentUser'));\r\n console.log(data);\r\n if(data!=null) a=true;\r\nvar login_state={\r\n  isLoginSuccess:a,\r\n  currentUser:user?user:[],\r\n  checkLogin:false\r\n}\r\nexport default function login_reducer(state =login_state, action) {\r\n  \r\n  if(action.type=='SET_LOGIN')\r\n  {  let newState={...state};\r\n      console.log(action.payload);\r\n     newState.isLoginSuccess=action.payload;\r\n     newState.currentUser=action.user;\r\n     console.log(newState.isLoginSuccess);\r\n    if(newState.isLoginSuccess==true) alert(\"dang nhap thanh cong\");\r\n    else if(newState.isLoginSuccess==false) alert(\"ban khong dang nhap duoc,vui long kiem tra lai\")\r\n     return newState;\r\n   }\r\n   if(action.type=='CHECK_LOGIN')\r\n   {let newState={...state};\r\n     newState.checkLogin=action.payload;\r\n     return newState;\r\n     \r\n   }\r\n   if(action.type=='LOG_OUT')\r\n   { let newState={...state};\r\n    newState.isLoginSuccess=action.payload;\r\n    if(newState.isLoginSuccess==false) alert('da log out');\r\n    newState.currentUser=[];\r\n   return newState;\r\n\r\n   }\r\n   return state;\r\n  \r\n}"]},"metadata":{},"sourceType":"module"}